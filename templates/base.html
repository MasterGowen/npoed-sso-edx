{% load static from staticfiles %}
<!doctype html>
<html lang="ru" xmlns="http://www.w3.org/1999/html">
<head>
  {% block head %}
    {% block meta %}
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
    {% endblock meta %}
    <link rel="icon" type="image/ico" href="/static/images/favicon.ico">
    <link rel="shortcut icon" type="image/ico" href="{% static '/static/images/favicon.ico' %}" />
    <title>
      {% block title %}Открытое образование{% endblock title %}
    </title>
    {% block css %}
      <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
      <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css" rel="stylesheet">
      <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
      <link href="{{ plp_url }}static/css/style.css" rel="stylesheet" type="text/css" />
      <style>
        body { background-color: #dedede; }
        h1 { padding: 0 30px; }
        .col-md-2 { width: 18.6667%; }
        .buttons { display: block; table-layout: fixed; border-radius: 7px; border: 1px solid #ccc;
                   margin: 20px; background: #eee; padding: 30px; }
        .buttons > div a { margin: 5px 10px; }
        .buttons > div:not(:first-child) { margin-top: 10px; border-top: 1px solid #ccc;
                                           padding-top: 10px; text-align: center; }
        .user-details { text-align: center; font-size: 16px; font-weight: bold; }
        .disconnect-form { padding: 0; margin: 0px 10px; }
        .disconnect-form > a { display: block; margin: 5px 0 !important; }
        .img-thumbnail { height: 30px; }
      </style>
    {% endblock css %}
    {% block extra_css %}
    {% endblock extra_css %}
  {% endblock head %}
</head>

<body class="{% block bodyclass %}{% endblock %}">

  {% block header %}
  <header class="global-header">
    <div class="container-fluid">
      <div class="top-bar row">
        <div class="col-xs-4 col-sm-4 col-md-3">
          <a class="logo" href="{{ plp_url }}"><img alt="" src="/static/images/logo-light.png"></a>
        </div>
        <div class="catalog-link col col-md-3 col-sm-3 hidden-xs">
          <a href="{{ plp_url }}course/"><span aria-hidden="true" class="icon catalog-icon"></span><span class="hidden-xs">Каталог курсов</span></a>
        </div>
        <div class="search-form hidden-xs col-sm-3 col-md-3  col">
        </div>
        <div class="version col-md-3 col-sm-1 text-right aut-block hidden-xs col">
        {% if not user.is_authenticated %}
          <span id="sb_login" class="l-btn" >
            <a href="{% url 'login' %}"><span class="icon profile-icon"></span><span class="hidden-sm hidden-xs">Войти</span></a>
          </span>
        {% else %}
          <div class="dropdown" id="sb_profile" style="width: 100%">
            <span class="dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown"><span class="icon profile-icon"></span><span class="hidden-sm">Мой профиль</span></span>
            <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="dropdownMenu1">
              <li role="presentation"><a role="menuitem" tabindex="-1" href="{{ plp_url }}my/" title="Мои курсы">Мои курсы</a></li>
              <li role="presentation"><a role="menuitem" tabindex="-1" href="{% url 'profile' %}" title="Профиль">Профиль</a></li>
              <li role="presentation"><a role="menuitem" tabindex="-1" href="{% url 'logout' %}" title="Выйти">Выйти</a></li>
            </ul>
          </div>
        {% endif %}
        </div>
      </div>
    </div>
  </header>
  {% endblock header %}

  <div class="container custom_container">
    {% block content %}
    {% endblock content %}
  </div>

  {% block footer %}
  <footer>
  <div class="container-fluid">
  <div class="row">
      <div class="col-md-5  col-sm-12 side left-side" style="margin-top: 0px;">
        <a href="/" class="pull-left"><img src="{% static 'img/logo-small.png' %}" alt="" class="logo-small"></a>
        <ul  class="list-unstyled">
          <li><a href="{{ plp_url }}course">Каталог курсов</a></li>
          <li><a href="{{ plp_url }}specialize">Направления подготовки</a></li>
        </ul>
      </div>
      <div class="col-md-7 side right-side hidden-xs">
        <div class="row">
          <div class="col-md-5 col-sm-6">
            <ul class="list-unstyled narrow">
              <li><a href="http://npoed.ru/about">О проекте</a></li>
              <li><a href="http://npoed.ru/faq">Вопрос-ответ</a></li>
            </ul>
          </div>
          <div class="col-md-7 col-sm-6">
            <ul class="list-unstyled wide">
              <li><a href="{{ plp_url }}terms/">Пользовательское соглашение</a></li>
              <li><a href="http://npoed.ru/contacts">Контактная информация</a></li>
            </ul>
          </div>

        </div>

      </div>
    </div>

    <div class="row copyright">
      <div class="col-md-5">
        &copy; 2015 Открытое образование
        <ul class="list-inline">
          <li>
            <a href="https://www.facebook.com/npoed"><img src="{% static 'img/social/fb.png' %}" alt=""></a>
            <a href="https://vk.com/npoed"><img src="{% static 'img/social/vk.png' %}" alt=""></a>
            <a href="http://ok.ru/group/52786563514445"><img src="{% static 'img/social/ok.png' %}" alt=""></a>
            <a href="https://instagram.com/npoed"><img src="{% static 'img/social/inst.png' %}" alt=""></a>
            <a href="https://twitter.com/npoed"><img src="{% static 'img/social/tw.png' %}" alt=""></a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  </footer>
  {% endblock footer %}

  {% block modals %}
  {% endblock modals %}

  {% block js %}
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="https://plus.google.com/js/client:plusone.js?onload=start" type="text/javascript"></script>
    <script src="https://login.persona.org/include.js" type="text/javascript"></script>

    <script type="text/javascript">
      var signInCallback = function (result) {
          if (result['error']) {
            alert('An error happened:', result['error']);
          } else {
            $('#code').attr('value', result['code']);
            $('#at').attr('value', result['access_token']);
            $('#google-plus').submit();
          }
      };

      var modalDialog = function (modalId, modalLinkName, submitHandler) {
        var $modal;

        $modal = $(modalId).modal({show: false});

        $modal.on('click', '.btn-primary', submitHandler || function (event) {
          event.preventDefault();
          $modal.find('form').submit();
        });

        if (modalLinkName) {
          $('a[name="' + modalLinkName + '"]').on('click', function (event) {
            event.preventDefault();
            $modal.modal('toggle');
          });
        }

        return $modal;
      };

      $(function () {
        var $validationModal, $emailRequired;

        modalDialog('#livejournal-modal', 'livejournal');
        modalDialog('#openid-modal', 'openid');
        modalDialog('#email-modal', 'email');
        modalDialog('#username-modal', 'username');
        $validationModal = modalDialog('#validation-sent-modal');
        $emailRequired = modalDialog('#email-required-modal');

        modalDialog('#ajax-login-modal', 'ajax-login', function (event) {
          var $backend, $accessToken, $accessTokenSecret, $fields, $result;
          event.preventDefault();

          $modal = $(this).closest('.modal');
          $form = $modal.find('form');
          $backend = $modal.find('[name="backend"]');
          $accessToken = $modal.find('[name="access_token"]');
          $accessTokenSecret = $modal.find('[name="access_token_secret"]');
          $result = $modal.find('.login-result');

          $.get('/ajax-auth/' + $backend.val() + '/', {
            access_token: $accessToken.val(),
            access_token_secret: $accessTokenSecret.val(),
          }, function (data, xhr, response) {
            $result.find('.user-id').html(data.id);
            $result.find('.user-username').html(data.username);
            $form.hide();
            $result.show();
            setTimeout(function () { window.location = '/'; }, 10000);
          }, 'json')
        });

        modalDialog('#persona-modal', 'persona', function (event) {
          var $form;
          event.preventDefault();

          $form = $(this).closest('form');
          navigator.id.get(function (assertion) {
            if (assertion) {
              $form.find('[name="assertion"]').val(assertion)
              $form.submit();
            } else {
              alert('An error occurred while getting your assertion, try again.');
            }
          });
        });

        $('.disconnect-form').on('click', 'a.btn', function (event) {
          event.preventDefault();
          $(event.target).closest('form').submit();
        });

        {% if validation_sent %}
          $validationModal.modal('show');
        {% endif %}

        {% if email_required %}
          $emailRequired.modal('show');
        {% endif %}
      });
    </script>
  {% endblock js %}

  {% block extra_js %}
  {% endblock extra_js %}

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-65311486-5', 'auto');
ga('send', 'pageview');</script><!-- Yandex.Metrika counter --> <script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter32212994 = new Ya.Metrika({ id:32212994, clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div><img src="https://mc.yandex.ru/watch/32212994" style="position:absolute; left:-9999px;" alt="" /></div></noscript> <!-- /Yandex.Metrika counter -->

</body>
</html>
